
R version 3.3.1 (2016-06-21) -- "Bug in Your Hair"
Copyright (C) 2016 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> args <- commandArgs(TRUE)
> pT <- as.character(args[1])
> inDEX <- as.character(args[2])
> 
> if (pT == "DD"){
+ load("W_EPIgeneSetN2_BayesianPrior/DN.adjustBeta.1.1.nI2000.nThin.1.index.22_04_Feb_12_2017.lof_DD.damaging_DD.nGroupDN.2.nGroupCC.2.adjustRatio.1.0.05.sigmaPrior.0.001.RData")}
> if (pT == "SCZ"){
+ load("W_EPIgeneSetN2_BayesianPrior/DN.adjustBeta.1.1.nI5000.nThin.1.index.14_20_Feb_12_2017.lof_SCZ.damaging_SCZ.nGroupDN.2.nGroupCC.2.adjustRatio.1.0.05.sigmaPrior.4.951.RData")
+ }
> if (pT == "ASD")
+     load("W_EPIgeneSetN2_BayesianPrior/DN.adjustBeta.1.1.nI5000.nThin.1.index.14_20_Feb_12_2017.lof_AST_TADA.damaging_AST_TADA.nGroupDN.2.nGroupCC.2.adjustRatio.1.0.05.sigmaPrior.2.551.RData")
> if (pT == "ID")
+     load("W_EPIgeneSetN2_BayesianPrior/DN.adjustBeta.1.1.nI2000.nThin.1.index.22_06_Feb_12_2017.lof_ID.damaging_ID.nGroupDN.2.nGroupCC.2.adjustRatio.1.0.05.sigmaPrior.4.951.RData")
> 
> ###########
> data2 <- read.table("~/psychen/methods/extTADA/scripts/TADA/data/ASC_2231trios_1333trans_1601cases_5397controls.csv", sep = ",", header = TRUE)
> 
> dirGeneSet <- "/hpc/users/nguyet26/psychen/methods/extTADA/Re_annotate/PvalueGeneList/genesListAllPaper/"
> gS1 <- dir(dirGeneSet, ".txt$")
> gS1L <- sapply(gS1, function(x) length(readLines(paste0(dirGeneSet, x))))
> gS1L <- gS1L[gS1L>100]
> gS1L <- gS1L[gS1L<4000]
> length(gS1L)
[1] 184
> geneSetName <- names(gS1L)
> 
> geneSetName <- geneSetName[grep("denovo|FDR|essentialGenes|listLoFtolerantEXAC|listMcRae2016.txt", geneSetName, ignore.case = TRUE, invert = TRUE)]
> #geneSetName <- head(geneSetName, 3)
> #geneSetName <- c("fmrp.txt")#, "constrained.txt")#, "essentialGenes.txt", "cahoy.txt", "psd95.txt", "mir137.txt", "synaptome.txt",     "GO:0009653.txt")
>                  ##Heart Disease
> #                 )
> 
> gAll <- data[, 1]
> geneSetM <- matrix(0, ncol = length(geneSetName), nrow = dim(data)[1])
> 
> for (ii in 1:length(geneSetName)){
+     g1 <- readLines(paste0(dirGeneSet, geneSetName[ii]))
+     g11 <- pmatch(g1, gAll)
+     g11 <- g11[!is.na(g11)]
+     if (dim(geneSetM)[2] > 1)
+     geneSetM[g11, ][, ii] <- 1
+     else
+         geneSetM[g11,] <- 1
+  #   print(length(g11)) #table(g11)
+ #    print(table(geneSetM[, ii]))
+ 
+     }
> 
> ###Remove not sig gene sets
> p1 <- NULL
> y <- rowSums(allDNData)
> for (i in 1:dim(geneSetM)[2]){
+     z <- geneSetM[, i]
+     a1 <- glm(z ~ y)
+     p1[i] <- (summary(a1)$coefficients)[2, 4]
+     p1[i] <- ifelse(is.na(p1[i]), 1, p1[i])
+ }
> 
> colnames(geneSetM) <- geneSetName
> #geneSetNameN <- geneSetName[p1 < 0.01]
> #geneSetMN <-    geneSetM[, geneSetNameN]
> 
> 
> names(p1) <- geneSetName
> p1 <- sort(p1)
> #geneSetM <- cbind(geneSetM, geneSetM,
>  #                 sample(0:1, size = dim(geneSetM)[1], replace = TRUE, prob = c(0.95, 1 - 0.95)),
>   #                sample(0:1, size = dim(geneSetM)[1], replace = TRUE, prob = c(0.9, 1 - 0.9)),
>    #               sample(0:1, size = dim(geneSetM)[1], replace = TRUE, prob = c(0.8, 1 - 0.8))             )
> #geneSetName <- c(geneSetName, paste0(geneSetName, "1"), "RandomGene1_0.05", "RandomGene2_0.1",  "RandomGene2_0.2")
> 
> ################
> 
> dD <- allDNData
> muRate <- allMutData
> nFamily <- mixDataKclasses$Ndn
> 
> geneSet <- geneSetM
> 
> nCol <- ncol(dD)
> nRow <- nrow(dD)
> nGeneSet <- ncol(geneSet)
> pars <- c(2, 30, 1, 1, rep(1, nGeneSet), 1)
> #pT = 1
> llk0 <- function(pars){
+         hyperGammaMean <- pars[1:nCol]
+         hyperBeta <- pars[(nCol + 1):(2*nCol)]
+         alpha0 <- pars[(2*nCol+1):(2*nCol + nGeneSet + 1)]
+ #        alphaIntercept <- tail(pars, 1)
+ 
+         f0 <- f1 <- 1
+         for (j in 1:nCol){
+             f0 <- f0*dpois(dD[, j], 2*nFamily[j]*muRate[, j])
+             f1<- f1*dnbinom(dD[, j], hyperGammaMean[j]*hyperBeta[j], hyperBeta[j]/(hyperBeta[j] + 2*nFamily[j]*muRate[, j]))
+             }
+         pi1 <- rep(exp(alpha0)/(1 + exp(alpha0)), dim(dD)[1])
+         
+         tllk <- sum(log(f1*pi1 + (1 - pi1)*f0))
+ ###lasso
+ #        tllk <- tllk - pT*sum(abs(alpha0))
+ #ridge 
+ #        tllk <- tllk - pT*sum((alpha0^2))
+ 
+         return(-tllk)
+     }
> 
> nGeneSet <- ncol(geneSet)
> nGeneSet = 0
> pars <- c(2, 30, 1, 1, rep(1, nGeneSet), 1)
> 
> 
> system.time(returnValue0 <- optim(par = pars, fn = llk0,
+                          lower = c(rep(1, nCol), rep(0.8, nCol), rep(-10, nGeneSet + 1)),
+                          upper = c(rep(200, nCol), rep(200, nCol), rep(10, nGeneSet + 1))))
   user  system elapsed 
  5.491   0.069   5.576 
Warning message:
In optim(par = pars, fn = llk0, lower = c(rep(1, nCol), rep(0.8,  :
  bounds can only be used with method L-BFGS-B (or Brent)
> 
> ####Add gene sets
> data2 <- read.table("~/psychen/methods/extTADA/scripts/TADA/data/ASC_2231trios_1333trans_1601cases_5397controls.csv", sep = ",", header = TRUE)
> 
> dirGeneSet <- "/hpc/users/nguyet26/psychen/methods/extTADA/Re_annotate/PvalueGeneList/genesListAllPaper/"
> gS1 <- dir(dirGeneSet, ".txt$")
> gS1L <- sapply(gS1, function(x) length(readLines(paste0(dirGeneSet, x))))
> gS1L <- gS1L[gS1L>100]
> gS1L <- gS1L[gS1L<4000]
> length(gS1L)
[1] 184
> geneSetName <- names(gS1L)
> 
> tOut <- returnValue0$value
> 
> ###Statrt to add genes
> llk1 <- function(pars){
+         hyperGammaMean <- pars[1:nCol]
+         hyperBeta <- pars[(nCol + 1):(2*nCol)]
+         alpha0 <- pars[(2*nCol+1):(2*nCol + nGeneSet)]
+         alphaIntercept <- tail(pars, 1)
+         f0 <- f1 <- 1
+         for (j in 1:nCol){
+             f0 <- f0*dpois(dD[, j], 2*nFamily[j]*muRate[, j])
+             f1<- f1*dnbinom(dD[, j], hyperGammaMean[j]*hyperBeta[j], hyperBeta[j]/(hyperBeta[j] + 2*nFamily[j]*muRate[, j]))
+             }
+         pi1 <- apply(geneSet, 1, function(x){
+             #pi1 = exp(geneSet)/(1 + exp(geneSet))
+             exp0 <- exp(alphaIntercept + sum(alpha0*x))
+             return(exp0/(1 + exp0))})
+         tllk <- sum(log(f1*pi1 + (1 - pi1)*f0))
+ ###lasso
+ #        tllk <- tllk - pT*sum(abs(alpha0))
+ #ridge 
+ #        tllk <- tllk - pT*sum((alpha0^2))
+ 
+         return(-tllk)
+     }
> 
> 
> 
>     geneSetName <- names(p1)
>     gAll <- data[, 1]
>     geneSetM <- matrix(0, ncol = length(geneSetName), nrow = dim(data)[1])
> 
> for (ii in 1:length(geneSetName)){
+     g1 <- readLines(paste0(dirGeneSet, geneSetName[ii]))
+     g11 <- pmatch(g1, gAll)
+     g11 <- g11[!is.na(g11)]
+     if (dim(geneSetM)[2] > 1)
+     geneSetM[g11, ][, ii] <- 1
+     else
+         geneSetM[g11,] <- 1
+  #   print(length(g11)) #table(g11)
+ #    print(table(geneSetM[, ii]))
+ 
+     }
> 
> 
> nStop = length(p1)
> geneSetA <- as.data.frame(geneSetM[, 1])
> i0=2
> rValueNew <- NULL
> rValueNew[1] <- returnValue0$value
> ij=1
> indexGene <- 1
> geneOut <- NULL
> tOut <- c(round(returnValue0$value, 3), "Intercept")
> 
> nMax <- length(p1)
> #nMax <- 6
> while (ij <= nMax) {
+ 
+     nCol <- ncol(dD)
+     nRow <- nrow(dD)
+     geneSet <- data.frame(geneSetM[, sort(unique(c(indexGene, ij)))])
+     nGeneSet <- ncol(geneSet)
+     message("nGeneSet: ", nGeneSet)
+     pars <- c(2, 30, 1, 1, rep(1, nGeneSet), 1)
+ #pT = 1
+ 
+     llk1 <- function(pars){
+         hyperGammaMean <- pars[1:nCol]
+         hyperBeta <- pars[(nCol + 1):(2*nCol)]
+         alpha0 <- pars[(2*nCol+1):(2*nCol + nGeneSet)]
+         alphaIntercept <- tail(pars, 1)
+         f0 <- f1 <- 1
+         for (j in 1:nCol){
+             f0 <- f0*dpois(dD[, j], 2*nFamily[j]*muRate[, j])
+             f1<- f1*dnbinom(dD[, j], hyperGammaMean[j]*hyperBeta[j], hyperBeta[j]/(hyperBeta[j] + 2*nFamily[j]*muRate[, j]))
+             }
+         pi1 <- apply(geneSet, 1, function(x){
+             #pi1 = exp(geneSet)/(1 + exp(geneSet))
+             exp0 <- exp(alphaIntercept + sum(alpha0*x))
+             return(exp0/(1 + exp0))})
+         tllk <- sum(log(f1*pi1 + (1 - pi1)*f0))
+ ###lasso
+ #        tllk <- tllk - pT*sum(abs(alpha0))
+ #ridge 
+ #        tllk <- tllk - pT*sum((alpha0^2))
+ 
+         return(-tllk)
+     }
+ 
+ 
+     
+     system.time(returnValue <- optim(par = pars, fn = llk1,
+                          lower = c(rep(1, nCol), rep(0.8, nCol), rep(-10, nGeneSet + 1)),
+                          upper = c(rep(200, nCol), rep(200, nCol), rep(10, nGeneSet + 1))))
+ 
+     message("logLLK: ", returnValue$value)
+     if ((returnValue$value - rValueNew[i0-1]) < -2){
+         indexGene <- c(indexGene, ij)
+         
+ #        geneSetA <- cbind(geneSetA, geneSetName[, jj])
+         rValueNew[i0] <- returnValue$value
+         i0 <- i0 + 1
+ 
+         message("i0: ", i0)
+         geneOut <- c(round(returnValue$value, 2), geneSetName[ij])
+         tOut <- rbind(tOut, geneOut ) #c(tOut, returnValue$value, pT, returnValue0$par, returnValue$par)
+ #        tOut <- round(tOut, 3)
+         write.table(tOut, paste0("Test_LLK/TestlogLLKxem.AddGenes.", annotationType, ".", annotationType2, ".",
+                             "txt2"),
+             quote = FALSE, col.names = FALSE, row.names = FALSE)
+         message("ADD gene set: ", geneSetName[ij])
+ 
+     } else {
+                 message("REMOVE gene set: ", geneSetName[ij])
+     }
+ 
+ 
+ 
+     ij = ij + 1
+ 
+     message("geneSetM: ", (dim(geneSetM)))
+     message("Running: ", ij)
+     
+ }
nGeneSet: 1
logLLK: 6685.42776221737
i0: 3
ADD gene set: fmrp.txt
geneSetM: 19358146
Running: 2
nGeneSet: 2
logLLK: 6614.57420186729
i0: 4
ADD gene set: ID.allKnownGenes.txt
geneSetM: 19358146
Running: 3
nGeneSet: 3
logLLK: 6614.5741962621
REMOVE gene set: List_ID_allKnownGene2.txt
geneSetM: 19358146
Running: 4
nGeneSet: 3
logLLK: 6585.71428460623
i0: 5
ADD gene set: constrained.txt
geneSetM: 19358146
Running: 5
nGeneSet: 4
logLLK: 6551.26492947277
i0: 6
ADD gene set: pLI09.txt
geneSetM: 19358146
Running: 6
nGeneSet: 5
logLLK: 6542.33031258414
i0: 7
ADD gene set: rbfox13.txt
geneSetM: 19358146
Running: 7
nGeneSet: 6
logLLK: 6542.14926799553
REMOVE gene set: rbfox2.txt
geneSetM: 19358146
Running: 8
nGeneSet: 6
logLLK: 6531.56825280012
i0: 8
ADD gene set: 1.essentila.txt
geneSetM: 19358146
Running: 9
nGeneSet: 7
logLLK: 6511.2239286337
i0: 9
ADD gene set: chd8.hNSC+human+mouse.txt
geneSetM: 19358146
Running: 10
nGeneSet: 8
logLLK: 6510.85993183894
REMOVE gene set: chd8.hNSC+human_brain.txt
geneSetM: 19358146
Running: 11
nGeneSet: 8
logLLK: 6506.21480601458
i0: 10
ADD gene set: GO:0006996.txt
geneSetM: 19358146
Running: 12
nGeneSet: 9
logLLK: 6505.33308020879
REMOVE gene set: GO:0007399.txt
geneSetM: 19358146
Running: 13
nGeneSet: 9
logLLK: 6504.87698739324
REMOVE gene set: chd8.human_brain.txt
geneSetM: 19358146
Running: 14
nGeneSet: 9
logLLK: 6506.07008378268
REMOVE gene set: GO:0016043.txt
geneSetM: 19358146
Running: 15
nGeneSet: 9
logLLK: 6505.8502581572
REMOVE gene set: MGI203861.abnormal_nervous_system_development.txt
geneSetM: 19358146
Running: 16
nGeneSet: 9
logLLK: 6506.03920949909
REMOVE gene set: GO:0071840.txt
geneSetM: 19358146
Running: 17
nGeneSet: 9
logLLK: 6504.0890118481
i0: 11
ADD gene set: GO:0043234.txt
geneSetM: 19358146
Running: 18
nGeneSet: 10
logLLK: 6498.20401995745
i0: 12
ADD gene set: MP:abnormal_hippocampus_morphology.txt
geneSetM: 19358146
Running: 19
nGeneSet: 11
logLLK: 6497.94642730203
REMOVE gene set: celf4.txt
geneSetM: 19358146
Running: 20
nGeneSet: 11
logLLK: 6497.60829275097
REMOVE gene set: MGI200913.abnormal_brain_development.txt
geneSetM: 19358146
Running: 21
nGeneSet: 11
logLLK: 6496.83595482089
REMOVE gene set: kirov_psych.ed.set.ARC+NMDAR+PSD95+mGluR5.txt
geneSetM: 19358146
Running: 22
nGeneSet: 11
logLLK: 6497.08615398763
REMOVE gene set: kirov_psych.ed.set.ARC.txt
geneSetM: 19358146
Running: 23
nGeneSet: 11
logLLK: 6496.84929519083
REMOVE gene set: kirov_psych.ed.set.mGluR5.txt
geneSetM: 19358146
Running: 24
nGeneSet: 11
logLLK: 6496.58790613195
REMOVE gene set: MGI200807.abnormal_hippocampus_morphology.txt
geneSetM: 19358146
Running: 25
nGeneSet: 11
logLLK: 6496.80056338494
REMOVE gene set: MGI200801.abnormal_temporal_lobe_morphology.txt
geneSetM: 19358146
Running: 26
nGeneSet: 11
logLLK: 6497.80768738347
REMOVE gene set: MGI200771.abnormal_brain_size.txt
geneSetM: 19358146
Running: 27
nGeneSet: 11
logLLK: 6497.90649548694
REMOVE gene set: MGI200783.abnormal_forebrain_morphology.txt
geneSetM: 19358146
Running: 28
nGeneSet: 11
logLLK: 6496.57949274689
REMOVE gene set: MP:seizures.txt
geneSetM: 19358146
Running: 29
nGeneSet: 11
logLLK: 6491.45353952006
i0: 13
ADD gene set: TTGTTT_V_FOXO4_01genes.txt
geneSetM: 19358146
Running: 30
nGeneSet: 12
logLLK: 6489.54481215557
REMOVE gene set: MGI203635.abnormal_synaptic_transmission.txt
geneSetM: 19358146
Running: 31
nGeneSet: 12
logLLK: 6489.9682560178
REMOVE gene set: Height_DEPICTgenes.txt
geneSetM: 19358146
Running: 32
nGeneSet: 12
logLLK: 6491.03346609748
REMOVE gene set: MGI204166.abnormal_limbic_system_morphology.txt
geneSetM: 19358146
Running: 33
nGeneSet: 12
logLLK: 6491.21361504674
REMOVE gene set: MGI208540.abnormal_cerebrum_morphology.txt
geneSetM: 19358146
Running: 34
nGeneSet: 12
logLLK: 6491.44536754426
REMOVE gene set: GO:0009653.txt
geneSetM: 19358146
Running: 35
nGeneSet: 12
logLLK: 6491.45167184609
REMOVE gene set: listgenePanous2016.txt
geneSetM: 19358146
Running: 36
nGeneSet: 12
logLLK: 6491.43973867578
REMOVE gene set: GO:0097458.txt
geneSetM: 19358146
Running: 37
nGeneSet: 12
logLLK: 6491.44940208431
REMOVE gene set: MGI200787.abnormal_telencephalon_morphology.txt
geneSetM: 19358146
Running: 38
nGeneSet: 12
logLLK: 6490.39958618433
REMOVE gene set: GGGAGGRR_V_MAZ_Q6genes.txt
geneSetM: 19358146
Running: 39
nGeneSet: 12
logLLK: 6489.93336882758
REMOVE gene set: MP:abnormal_behavior.txt
geneSetM: 19358146
Running: 40
nGeneSet: 12
logLLK: 6491.38329715549
REMOVE gene set: GO:0043005.txt
geneSetM: 19358146
Running: 41
nGeneSet: 12
logLLK: 6491.24252568526
REMOVE gene set: MGI202151.abnormal_neural_tube_morphologydevelopment.txt
geneSetM: 19358146
Running: 42
nGeneSet: 12
logLLK: 6490.37424961706
REMOVE gene set: psd.txt
geneSetM: 19358146
Running: 43
nGeneSet: 12
logLLK: 6488.34353599367
i0: 14
ADD gene set: synaptome.txt
geneSetM: 19358146
Running: 44
nGeneSet: 13
logLLK: 6487.79257301877
REMOVE gene set: mir137.txt
geneSetM: 19358146
Running: 45
nGeneSet: 13
logLLK: 6483.88957933231
i0: 15
ADD gene set: all_noscz_super.sets.Pre_post_synaptic_genes.txt
geneSetM: 19358146
Running: 46
nGeneSet: 14
logLLK: 6483.71846754381
REMOVE gene set: MP:abnormal_cerebral_cortex_morphology.txt
geneSetM: 19358146
Running: 47
nGeneSet: 14
logLLK: 6482.58137254194
REMOVE gene set: MGI202206.abnormal_CNS_synaptic_transmission.txt
geneSetM: 19358146
Running: 48
nGeneSet: 14
logLLK: 6477.91830925334
i0: 16
ADD gene set: MP:abnormal_miniature_excitatory_postsynaptic_currents.txt
geneSetM: 19358146
Running: 49
nGeneSet: 15
logLLK: 6477.26297509321
REMOVE gene set: MGI202882.abnormal_neuron_morphology.txt
geneSetM: 19358146
Running: 50
nGeneSet: 15
logLLK: 6477.89856529917
REMOVE gene set: MGI200788.abnormal_cerebral_cortex_morphology.txt
geneSetM: 19358146
Running: 51
nGeneSet: 15
logLLK: 6477.89856529917
REMOVE gene set: MGI200788:abnormal_cerebral_cortex_morphology.txt
geneSetM: 19358146
Running: 52
nGeneSet: 15
logLLK: 6476.36096999775
REMOVE gene set: MGI203232.abnormal_forebrain_development.txt
geneSetM: 19358146
Running: 53
nGeneSet: 15
logLLK: 6477.68449477939
REMOVE gene set: MP:abnormal_neuronal_migration.txt
geneSetM: 19358146
Running: 54
nGeneSet: 15
logLLK: 6477.27478585651
REMOVE gene set: GO:0042995.txt
geneSetM: 19358146
Running: 55
nGeneSet: 15
logLLK: 6476.71855619316
REMOVE gene set: MP:abnormal_nervous_system_electrophysiology.txt
geneSetM: 19358146
Running: 56
nGeneSet: 15
logLLK: 6477.16890077842
REMOVE gene set: MGI204811.abnormal_neuron_physiology.txt
geneSetM: 19358146
Running: 57
nGeneSet: 15
logLLK: 6476.64801382923
REMOVE gene set: MP:abnormal_motor_capabilitiesORcoordinationORmovement.txt
geneSetM: 19358146
Running: 58
nGeneSet: 15
logLLK: 6477.74016423045
REMOVE gene set: MGI205277.abnormal_brainstem_morphology.txt
geneSetM: 19358146
Running: 59
nGeneSet: 15
logLLK: 6477.87133338763
REMOVE gene set: MGI200841.abnormal_hindbrain_morphology.txt
geneSetM: 19358146
Running: 60
nGeneSet: 15
logLLK: 6477.26125010271
REMOVE gene set: MP:abnormal_brain_development.txt
geneSetM: 19358146
Running: 61
nGeneSet: 15
logLLK: 6477.86264206054
REMOVE gene set: MGI202272.abnormal_nervous_system_electrophysiology.txt
geneSetM: 19358146
Running: 62
nGeneSet: 15
logLLK: 6477.02505868071
REMOVE gene set: GO:0034702.txt
geneSetM: 19358146
Running: 63
nGeneSet: 15
logLLK: 6477.91709024679
REMOVE gene set: psd95.txt
geneSetM: 19358146
Running: 64
nGeneSet: 15
logLLK: 6477.9109025201
REMOVE gene set: MP:abnormal_brain_morphology.txt
geneSetM: 19358146
Running: 65
nGeneSet: 15
logLLK: 6476.06780027005
REMOVE gene set: xescape.txt
geneSetM: 19358146
Running: 66
nGeneSet: 15
logLLK: 6477.88266418437
REMOVE gene set: MP:abnormal_excitatory_postsynaptic_currents.txt
geneSetM: 19358146
Running: 67
nGeneSet: 15
logLLK: 6477.84605754566
REMOVE gene set: MP:abnormal_CNS_synaptic_transmission.txt
geneSetM: 19358146
Running: 68
nGeneSet: 15
logLLK: 6476.3469534192
REMOVE gene set: MGI202067.abnormal_sensory_capabilitiesreflexesnociception.txt
geneSetM: 19358146
Running: 69
nGeneSet: 15
logLLK: 6477.87505045008
REMOVE gene set: MGI201468.abnormal_temporal_memory.txt
geneSetM: 19358146
Running: 70
nGeneSet: 15
logLLK: 6477.84342277796
REMOVE gene set: MP:abnormal_nervous_system_morphology.txt
geneSetM: 19358146
Running: 71
nGeneSet: 15
logLLK: 6477.90330182103
REMOVE gene set: GO:0005261.txt
geneSetM: 19358146
Running: 72
nGeneSet: 15
logLLK: 6477.71407063923
REMOVE gene set: MGI206108.abnormal_hindbrain_development.txt
geneSetM: 19358146
Running: 73
nGeneSet: 15
logLLK: 6477.61088363961
REMOVE gene set: GO:0022836.txt
geneSetM: 19358146
Running: 74
nGeneSet: 15
logLLK: 6477.61088363961
REMOVE gene set: GO:0022839.txt
geneSetM: 19358146
Running: 75
nGeneSet: 15
logLLK: 6476.85013892668
REMOVE gene set: MGI202063.abnormal_learningmemoryconditioning.txt
geneSetM: 19358146
Running: 76
nGeneSet: 15
logLLK: 6477.64427685514
REMOVE gene set: MGI209745.abnormal_behavioral_response_to_xenobiotic.txt
geneSetM: 19358146
Running: 77
nGeneSet: 15
logLLK: 6477.91761258166
REMOVE gene set: MGI200830.abnormal_diencephalon_morphology.txt
geneSetM: 19358146
Running: 78
nGeneSet: 15
logLLK: 6477.48603422039
REMOVE gene set: MGI202184.abnormal_innervation.txt
geneSetM: 19358146
Running: 79
nGeneSet: 15
logLLK: 6477.81520325598
REMOVE gene set: MGI208415.abnormal_neurite_morphology.txt
geneSetM: 19358146
Running: 80
nGeneSet: 15
logLLK: 6477.31988488111
REMOVE gene set: kirov_psych.ed.set.Synaptic_vesicle.txt
geneSetM: 19358146
Running: 81
nGeneSet: 15
logLLK: 6476.02079092721
REMOVE gene set: kirov_psych.ed.set.Pre-synapse.txt
geneSetM: 19358146
Running: 82
nGeneSet: 15
logLLK: 6477.51368321557
REMOVE gene set: kirov_psych.ed.set.Pre-synaptic_active_zone.txt
geneSetM: 19358146
Running: 83
nGeneSet: 15
logLLK: 6477.89025840721
REMOVE gene set: MP:abnormal_neuron_differentiation.txt
geneSetM: 19358146
Running: 84
nGeneSet: 15
logLLK: 6477.91450934366
REMOVE gene set: MGI200778.abnormal_nervous_system_tract_morphology.txt
geneSetM: 19358146
Running: 85
nGeneSet: 15
logLLK: 6476.722384906
REMOVE gene set: MP:abnormal_neuron_morphology.txt
geneSetM: 19358146
Running: 86
nGeneSet: 15
logLLK: 6477.91401405178
REMOVE gene set: MGI208026.abnormal_brain_white_matter_morphology.txt
geneSetM: 19358146
Running: 87
nGeneSet: 15
logLLK: 6477.91457020438
REMOVE gene set: MP:abnormal_neuron_physiology.txt
geneSetM: 19358146
Running: 88
nGeneSet: 15
logLLK: 6477.85248992514
REMOVE gene set: MGI200822.abnormal_brain_ventricle_morphology.txt
geneSetM: 19358146
Running: 89
nGeneSet: 15
logLLK: 6477.90150318846
REMOVE gene set: MP:abnormal_axon_morphology.txt
geneSetM: 19358146
Running: 90
nGeneSet: 15
logLLK: 6476.43683773572
REMOVE gene set: panoustable2.txt
geneSetM: 19358146
Running: 91
nGeneSet: 15
logLLK: 6477.31574857741
REMOVE gene set: MP:abnormal_excitatory_postsynaptic_potential.txt
geneSetM: 19358146
Running: 92
nGeneSet: 15
logLLK: 6477.91643124084
REMOVE gene set: MGI202200.abnormal_brain_ventriclechoroid_plexus_morphology.txt
geneSetM: 19358146
Running: 93
nGeneSet: 15
logLLK: 6477.68639885218
REMOVE gene set: GO:0045202.txt
geneSetM: 19358146
Running: 94
nGeneSet: 15
logLLK: 6477.08296350791
REMOVE gene set: MP:abnormal_innervation.txt
geneSetM: 19358146
Running: 95
nGeneSet: 15
logLLK: 6477.82727630351
REMOVE gene set: MP:abnormal_forebrain_morphology.txt
geneSetM: 19358146
Running: 96
nGeneSet: 15
logLLK: 6477.8670125166
REMOVE gene set: MGI202207.abnormal_long_term_potentiation.txt
geneSetM: 19358146
Running: 97
nGeneSet: 15
logLLK: 6477.63256131633
REMOVE gene set: MGI205404.abnormal_axon_morphology.txt
geneSetM: 19358146
Running: 98
nGeneSet: 15
logLLK: 6477.81258609756
REMOVE gene set: MGI202572.abnormal_emotionaffect_behavior.txt
geneSetM: 19358146
Running: 99
nGeneSet: 15
logLLK: 6477.89673214045
REMOVE gene set: GO:0015075.txt
geneSetM: 19358146
Running: 100
nGeneSet: 15
logLLK: 6477.02502282874
REMOVE gene set: kirov_psych.ed.set.Nucleus.txt
geneSetM: 19358146
Running: 101
nGeneSet: 15
logLLK: 6477.87722484093
REMOVE gene set: MGI202065.abnormal_fearanxiety-related_behavior.txt
geneSetM: 19358146
Running: 102
nGeneSet: 15
logLLK: 6475.60533730045
i0: 17
ADD gene set: GO:0051234.txt
geneSetM: 19358146
Running: 103
nGeneSet: 16
logLLK: 6475.93649624095
REMOVE gene set: GO:0006810.txt
geneSetM: 19358146
Running: 104
nGeneSet: 16
logLLK: 6474.79730415476
REMOVE gene set: MGI200955.abnormal_spinal_cord_morphology.txt
geneSetM: 19358146
Running: 105
nGeneSet: 16
logLLK: 6475.15857602219
REMOVE gene set: GO:0051129.txt
geneSetM: 19358146
Running: 106
nGeneSet: 16
logLLK: 6475.59917952297
REMOVE gene set: GO:0044765.txt
geneSetM: 19358146
Running: 107
nGeneSet: 16
logLLK: 6475.52085154906
REMOVE gene set: MP:abnormal_spatial_learning.txt
geneSetM: 19358146
Running: 108
nGeneSet: 16
logLLK: 6475.44919946455
REMOVE gene set: MGI201463.abnormal_spatial_learning.txt
geneSetM: 19358146
Running: 109
nGeneSet: 16
logLLK: 6475.31964821563
REMOVE gene set: GO:0055085.txt
geneSetM: 19358146
Running: 110
nGeneSet: 16
logLLK: 6469.75102031275
i0: 18
ADD gene set: x.escape.txt
geneSetM: 19358146
Running: 111
nGeneSet: 17
logLLK: 6469.74361345369
REMOVE gene set: MGI202062.abnormal_associative_learning.txt
geneSetM: 19358146
Running: 112
nGeneSet: 17
logLLK: 6469.6610052803
REMOVE gene set: MGI202752.abnormal_somatic_nervous_system_morphology.txt
geneSetM: 19358146
Running: 113
nGeneSet: 17
logLLK: 6469.54555446439
REMOVE gene set: GO:0022892.txt
geneSetM: 19358146
Running: 114
nGeneSet: 17
logLLK: 6469.63306637619
REMOVE gene set: GO:1901564.txt
geneSetM: 19358146
Running: 115
nGeneSet: 17
logLLK: 6469.6443508067
REMOVE gene set: GO:0045211.txt
geneSetM: 19358146
Running: 116
nGeneSet: 17
logLLK: 6469.55918002436
REMOVE gene set: GO:0097060.txt
geneSetM: 19358146
Running: 117
nGeneSet: 17
logLLK: 6469.73563325141
REMOVE gene set: GO:0044456.txt
geneSetM: 19358146
Running: 118
nGeneSet: 17
logLLK: 6469.16352988472
REMOVE gene set: MGI203634.abnormal_glial_cell_morphology.txt
geneSetM: 19358146
Running: 119
nGeneSet: 17
logLLK: 6468.20056357301
REMOVE gene set: MGI202557.abnormal_socialconspecific_interaction.txt
geneSetM: 19358146
Running: 120
nGeneSet: 17
logLLK: 6469.67300447947
REMOVE gene set: clock.sets.CLOCK-CONTROLLED_PERVASIVE.txt
geneSetM: 19358146
Running: 121
nGeneSet: 17
logLLK: 6469.21981607464
REMOVE gene set: MGI203107.abnormal_response_to_novelty.txt
geneSetM: 19358146
Running: 122
nGeneSet: 17
logLLK: 6469.24366286789
REMOVE gene set: xlid.gcc.txt
geneSetM: 19358146
Running: 123
nGeneSet: 17
logLLK: 6469.24366286789
REMOVE gene set: xlid.txt
geneSetM: 19358146
Running: 124
nGeneSet: 17
logLLK: 6469.70504845681
REMOVE gene set: MP:thin_cerebral_cortex.txt
geneSetM: 19358146
Running: 125
nGeneSet: 17
logLLK: 6469.03368328705
REMOVE gene set: MGI200952.abnormal_CNS_glial_cell_morphology.txt
geneSetM: 19358146
Running: 126
nGeneSet: 17
logLLK: 6469.45227880226
REMOVE gene set: MGI209937.abnormal_neuron_differentiation.txt
geneSetM: 19358146
Running: 127
nGeneSet: 17
logLLK: 6469.75141936906
REMOVE gene set: GO:0005215.txt
geneSetM: 19358146
Running: 128
nGeneSet: 17
logLLK: 6469.48432666783
REMOVE gene set: MGI201413.abnormal_response_to_new_environment.txt
geneSetM: 19358146
Running: 129
nGeneSet: 17
logLLK: 6468.95289674135
REMOVE gene set: geneInPARs.txt
geneSetM: 19358146
Running: 130
nGeneSet: 17
logLLK: 6469.58836562899
REMOVE gene set: MGI203202.abnormal_neuron_apoptosis.txt
geneSetM: 19358146
Running: 131
nGeneSet: 17
logLLK: 6469.66192317001
REMOVE gene set: MGI202068.abnormal_parental_behavior.txt
geneSetM: 19358146
Running: 132
nGeneSet: 17
logLLK: 6469.46448109215
REMOVE gene set: geneInHARs.txt
geneSetM: 19358146
Running: 133
nGeneSet: 17
logLLK: 6469.64311472739
REMOVE gene set: MP:abnormal_myelination.txt
geneSetM: 19358146
Running: 134
nGeneSet: 17
logLLK: 6468.15893111932
REMOVE gene set: GO:0032956.txt
geneSetM: 19358146
Running: 135
nGeneSet: 17
logLLK: 6469.28330412791
REMOVE gene set: GO:0015276.txt
geneSetM: 19358146
Running: 136
nGeneSet: 17
logLLK: 6469.28330412791
REMOVE gene set: GO:0022834.txt
geneSetM: 19358146
Running: 137
nGeneSet: 17
logLLK: 6469.70912323403
REMOVE gene set: GO:0070925.txt
geneSetM: 19358146
Running: 138
nGeneSet: 17
logLLK: 6469.68701167048
REMOVE gene set: all_noscz_super.sets.Circadian_clock_genes.txt
geneSetM: 19358146
Running: 139
nGeneSet: 17
logLLK: 6469.51234997889
REMOVE gene set: MGI200920.abnormal_myelination.txt
geneSetM: 19358146
Running: 140
nGeneSet: 17
logLLK: 6466.2824025004
i0: 19
ADD gene set: TWAS_scz_Gusev_August2016.txt
geneSetM: 19358146
Running: 141
nGeneSet: 18
logLLK: 6465.56302625546
REMOVE gene set: kirov_control_ed.set.Mitochondrion_(core).txt
geneSetM: 19358146
Running: 142
nGeneSet: 18
logLLK: 6465.97046321341
REMOVE gene set: all_noscz_super.sets.BP_SCZ_genetics.txt
geneSetM: 19358146
Running: 143
nGeneSet: 18
logLLK: 6466.24086481859
REMOVE gene set: clock.sets.CLOCK-MODULATORS.txt
geneSetM: 19358146
Running: 144
nGeneSet: 18
logLLK: 6466.70935747063
REMOVE gene set: kirov_control_ed.set.Cytoplasm_(core).txt
geneSetM: 19358146
Running: 145
nGeneSet: 18
logLLK: 6466.2824025004
REMOVE gene set: MGI202062:abnormal_associative_learning.txt
geneSetM: 19358146
Running: 146
nGeneSet: 18
logLLK: 6466.2824025004
REMOVE gene set: symbol_checkerPARs.txt
geneSetM: 19358146
Running: 147
There were 50 or more warnings (use warnings() to see the first 50)
> 
> proc.time()
     user    system   elapsed 
75459.729    12.709 75774.180 
