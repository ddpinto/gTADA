* Forward selection
[[./submit.IncreaseLLK.sh]]
#Only de novo data
[[./increaseLLK1_removeLowLK1_useNLMINB.R]]
#Combine DN + CC
[[./increaseLLK1_removeLowLK1_useNLMINB_bothDNandCC.R]]

* MCMC for whole data
[[./submitJobs.ForArrayRealDataEPIandIDandDD.sh]]
[[./submitJobs.ForArrayRealDataEPIandIDandDDforEachAnnotation.sh]]
[[./script_EPI_ID_denovo_Sep_2016_DN_useNewGeneSetsForEachGeneSets.R]]
** Combine DN+CC (for SCZ and DN)
[[./submitJobs.ForArrayRealDataGeneSet.sh]]
[[./submitJobs.ForArrayRealDataGeneSetForEachAnno.sh]]
scriptSCZ2017usingGeneSet.R
** Cross validation
[[./script_EPI_ID_denovo_Sep_2016_DN_useNewGeneSetsCV_Kfold.R]]
 

* Simulated data
** Only DN data
[[./submitJobs.GeneSetOnlyDN.sh]]
[[./gTADAsimulateDataSimulation.R]]


testSimulatedGeneSet.R


* Stuff to run
[[./testGeneSet.R]]
# A likelihood function to test
[[./likelihoodFunction2Test.R]]

cat LogLK.adjustBeta.1.3.nI10000.nThin.1.index.12_0* > ../result.CR10.RealData.LaplacePrior.txt 

####Get cross-validation results
for i in $(seq 1 1 10)
do
cat W_AddGeneSetKF6_NormalPrior/*kF.${i}.text > result.CR10.RealData.normal.${i}.txt
done

###
cat W_SCZgeneSetEachGeneSet/EstimatedPars.*|grep ".txt"|\
 grep 'alpha0\[2\]'|awk '($3>0 && $4>0 && $5>0)' > result.SingleGeneSet.SCZ.txt 

cat W_SCZgeneSetEachGeneSet/EstimatedPars.*|grep ".txt"|\
 grep 'alpha0\[2\]'|awk '($3<0 && $4<0 && $5<0)' > result.SingleGeneSet.SCZ.negative.txt 


cat W_AUTgeneSetEachGeneSet/EstimatedPars.*|grep ".txt"|\
 grep 'alpha0\[2\]'|awk '($3>0 && $4>0 && $5>0)'|sed 's/SCZ/AUT/g' > result.SingleGeneSet.AUT.txt 

cat W_AUTgeneSetEachGeneSet/EstimatedPars.*|grep ".txt"|\
 grep 'alpha0\[2\]'|awk '($3<0 && $4<0 && $5<0)'|sed 's/SCZ/AUT/g' > result.SingleGeneSet.AUT.negative.txt 

cat W_EACHannotation/EstimatedPars.*|grep ".txt"|grep DD |\
 grep 'alpha0\[2\]'|awk '($5<0 && $6<0 && $7<0)' > result.SingleGeneSet.DD.negative.txt 

cat W_EACHannotation/EstimatedPars.*|grep ".txt"|grep 'lof_DD' |\
 grep 'alpha0\[2\]'|awk '($5>0 && $6>0 && $7>0)' > result.SingleGeneSet.DD.txt 

cat W_EACHannotation/EstimatedPars.*|grep ".txt"|grep 'lof_ID' |\
 grep 'alpha0\[2\]'|awk '($5<0 && $6<0 && $7<0)' > result.SingleGeneSet.ID.negative.txt 

cat W_EACHannotation/EstimatedPars.*|grep ".txt"|grep 'lof_ID' |\
 grep 'alpha0\[2\]'|awk '($5>0 && $6>0 && $7>0)' > result.SingleGeneSet.ID.txt 

cat W_EACHannotation/EstimatedPars.*|grep ".txt"|grep 'lof_EPI' |\
 grep 'alpha0\[2\]'|awk '($5<0 && $6<0 && $7<0)' > result.SingleGeneSet.EPI.negative.txt 

cat W_EACHannotation/EstimatedPars.*|grep ".txt"|grep 'lof_EPI' |\
 grep 'alpha0\[2\]'|awk '($5>0 && $6>0 && $7>0)' > result.SingleGeneSet.EPI.txt 




* Draw pictures
[[./drawChoosingModelUseCrossValidationPlots.R]]
[[./drawEnrichmentForSingleGeneSet.R]]



