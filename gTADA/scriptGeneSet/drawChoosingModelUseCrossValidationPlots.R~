###Test CR
xC <- read.table("result.CR10.RealData.txt", as.is = TRUE)
xC <- read.table("result.CR10.RealData.LaplacePrior.txt", as.is = TRUE)
xC <- read.table("result.CR10.RealData.normal.txt", as.is = TRUE)
#xC <- read.table("result.CR10.RealData.txt2", as.is = TRUE)
library("dplyr")
xC1 <- xC %>% group_by(V1, V2, V3) %>% summarise(mK = mean(V5), mL = mean(V4))
xC2 <- as.data.frame(xC1)

xC2 <- data.frame(xC1)
xC2[, c(4, 5)] <- apply(xC2[, c(4, 5)], 2, function(x) round(x, 0))

pdf("~/www/Test/CVplot.pdf")
par(mfrow = c(2, 3))
for (ii in names(table(xC2[, 2]))){
    temp1 <- xC2[xC2[, 2] == ii,]
    plot(temp1[, 3], temp1[, 5], main = ii, xlab = 'sigmaPrior', ylab = 'logLLK', type = 'l',
         xlim = c(0, 15))
    t10 <-  temp1[which(temp1[, 5] == max(temp1[, 5])), 3][1]
    t11 <-  temp1[is.element(temp1[, 3], t10),][, 5][1]
    abline(v = t10, col = 'red')
    text(t10, t11 -5,
         paste0(t10, "-", t11), srt = 45, lwd = 0.7, cex = 0.7)

    if (ii == "damaging_DD")
        text(3.2, -4756, "*", col = 'red')
}
dev.off()

#####################
###
xC3 <- xC2[grep("damaging", xC2[, 2]),]
library("ggplot2")

pdf("~/www/Test/CVplot.pdf")
par(mfrow = c(3, 3))
for (ii in names(table(xC3[, 2]))){
    temp1 <- xC3[xC3[, 2] == ii,]
    plot(temp1[, 3], temp1[, 5], main = ii, xlab = 'sigmaPrior', ylab = 'logLLK', type = 'l',
         xlim = c(0, 15))
    t10 <-  temp1[which(temp1[, 5] == max(temp1[, 5])), 3][1]
    t11 <-  temp1[is.element(temp1[, 3], t10),][, 5][1]
    abline(v = t10, col = 'red')
    text(t10, t11 -8,
         paste0(t10, "-", t11), srt = 45, lwd = 0.7, cex = 0.6)

    if (ii == "damaging_DD")
        text(3.2, -5746, "*", col = 'red', cex = 1.3)

}
dev.off()

colnames(xC3) <- c("Anno1", "Anno2", "sigmaPrior", "llk1", "llk")

p1 <- ggplot(xC3, aes(sigmaPrior, llk)) + geom_line()
p1 <- p1 + facet_grid(. ~ Anno2)

pdf("~/www/Test/CV2.pdf")
print(p1)
dev.off()

xC3[grep("DD", xC3[, 2]),]
